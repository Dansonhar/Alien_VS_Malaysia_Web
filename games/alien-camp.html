<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Alien Camp? Not Here! - Aliens vs Malaysians</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 'fredoka': ['Fredoka', 'sans-serif'] },
                    colors: { 'sambal': '#FF5252', 'durian': '#FFD600', 'pandan': '#00E676' }
                }
            }
        }
    </script>
</head>

<body class="font-fredoka bg-amber-800 min-h-screen overflow-hidden touch-none select-none">

    <!-- HUD -->
    <div class="fixed top-4 left-1/2 -translate-x-1/2 z-50 flex gap-4 pointer-events-none">
        <div class="bg-white/90 px-4 py-2 rounded-full border-4 border-black shadow-[4px_4px_0_#000] font-bold text-lg">
            SCORE: <span id="score" class="text-pandan">0</span>
        </div>
        <div class="bg-white/90 px-4 py-2 rounded-full border-4 border-black shadow-[4px_4px_0_#000] font-bold text-lg">
            <span id="timer" class="text-sambal">60</span>s
        </div>
    </div>

    <canvas id="gameCanvas" class="block w-full h-screen cursor-crosshair relative z-10"></canvas>

    <!-- Start Screen -->
    <div id="startScreen"
        class="fixed inset-0 bg-black/85 flex flex-col items-center justify-center z-[100] text-center px-4">
        <h1 class="text-4xl md:text-5xl font-bold text-pandan drop-shadow-[0_4px_0_#000] mb-4">
            ALIEN CAMP?<br>NOT HERE!
        </h1>
        <p class="text-white text-lg mb-6">Aliens are building illegal camps!<br>Throw grenades to clear them out.</p>
        <button onclick="startGame()"
            class="bg-orange-500 text-white font-bold text-xl px-8 py-4 rounded-full border-4 border-black shadow-[6px_6px_0_#000] hover:shadow-[8px_8px_0_#000] hover:-translate-y-1 transition-all">
            THROW GRENADE!
        </button>
    </div>

    <!-- End Screen -->
    <div id="endScreen"
        class="hidden fixed inset-0 bg-black/85 flex flex-col items-center justify-center z-[100] text-center px-4">
        <h1 class="text-4xl md:text-5xl font-bold text-durian drop-shadow-[0_4px_0_#000] mb-4">
            ILLEGAL SETTLEMENT CLEARED!
        </h1>
        <p class="text-white text-xl mb-2">Camps Destroyed:</p>
        <div id="finalScore" class="text-6xl font-bold text-pandan drop-shadow-[0_4px_0_#000] mb-6">0</div>
        <button onclick="startGame()"
            class="bg-pandan text-black font-bold text-xl px-8 py-4 rounded-full border-4 border-black shadow-[6px_6px_0_#000] hover:shadow-[8px_8px_0_#000] hover:-translate-y-1 transition-all">
            CLEAR MORE
        </button>
        <button onclick="window.location.href='../'"
            class="mt-4 bg-gray-600 text-white font-bold px-6 py-2 rounded-full border-2 border-black">
            BACK TO MENU
        </button>
    </div>

    <button onclick="window.location.href='../'"
        class="fixed bottom-4 left-4 z-[200] bg-red-500 hover:bg-red-600 text-white font-bold px-6 py-3 rounded-xl border-4 border-black shadow-[4px_4px_0_#000] hover:shadow-[2px_2px_0_#000] hover:translate-y-[2px] transition-all flex items-center gap-2">
        <span class="text-2xl">üè†</span> BACK TO MENU
    </button>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        let width, height;
        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        let gameRunning = false;
        let score = 0;
        let timeLeft = 60;
        let timerInterval = null;
        let camps = [];
        let particles = [];
        let grenades = [];
        let frameCount = 0;
        let spawnRate = 120;

        class Camp {
            constructor() {
                this.x = Math.random() * (width - 100) + 50;
                this.y = Math.random() * (height - 150) + 100;
                this.size = 0;
                this.maxSize = 80;
                this.growthRate = 0.2;
                this.built = false;
            }
            update() {
                if (this.size < this.maxSize) this.size += this.growthRate;
                else this.built = true;
            }
            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.fillStyle = this.built ? '#3E2723' : '#8D6E63';
                ctx.beginPath();
                ctx.moveTo(-this.size / 2, this.size / 2);
                ctx.lineTo(0, -this.size / 2);
                ctx.lineTo(this.size / 2, this.size / 2);
                ctx.fill();
                if (!this.built) {
                    ctx.strokeStyle = '#FFEB3B';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                }
                if (this.size > 20) {
                    ctx.fillStyle = '#76FF03';
                    ctx.beginPath();
                    ctx.arc(-10, 10, 5, 0, Math.PI * 2);
                    ctx.arc(10, 10, 5, 0, Math.PI * 2);
                    ctx.fill();
                }
                ctx.restore();
            }
        }

        class Grenade {
            constructor(tx, ty) {
                this.x = width / 2;
                this.y = height;
                this.tx = tx;
                this.ty = ty;
                this.progress = 0;
                this.exploded = false;
            }
            update() {
                if (this.exploded) return;
                this.progress += 0.05;
                if (this.progress >= 1) {
                    this.progress = 1;
                    this.explode();
                }
                this.x = (width / 2) + (this.tx - width / 2) * this.progress;
                this.y = height + (this.ty - height) * this.progress;
                this.z = Math.sin(this.progress * Math.PI) * 100;
            }
            draw() {
                if (this.exploded) return;
                ctx.save();
                ctx.translate(this.x, this.y - (this.z || 0));
                ctx.fillStyle = '#4CAF50';
                ctx.beginPath();
                ctx.arc(0, 0, 10, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#BDBDBD';
                ctx.fillRect(-2, -14, 4, 6);
                ctx.restore();
                ctx.fillStyle = 'rgba(0,0,0,0.3)';
                ctx.beginPath();
                ctx.ellipse(this.x, this.y, 8, 3, 0, 0, Math.PI * 2);
                ctx.fill();
            }
            explode() {
                this.exploded = true;
                for (let i = 0; i < 20; i++) {
                    particles.push({
                        x: this.tx, y: this.ty,
                        vx: (Math.random() - 0.5) * 10,
                        vy: (Math.random() - 0.5) * 10,
                        life: 1.0,
                        color: `hsl(${Math.random() * 60 + 10}, 100%, 50%)`
                    });
                }
                for (let i = camps.length - 1; i >= 0; i--) {
                    let c = camps[i];
                    let d = Math.hypot(c.x - this.tx, c.y - this.ty);
                    if (d < c.size + 50) {
                        camps.splice(i, 1);
                        score++;
                        document.getElementById('score').textContent = score;
                    }
                }
            }
        }

        function startGame() {
            score = 0;
            timeLeft = 60;
            frameCount = 0;
            camps = [];
            grenades = [];
            particles = [];
            gameRunning = true;
            document.getElementById('score').textContent = 0;
            document.getElementById('timer').textContent = 60;
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('endScreen').classList.add('hidden');

            // Spawn a few initial camps
            for (let i = 0; i < 3; i++) {
                camps.push(new Camp());
            }

            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;
                if (timeLeft <= 0) {
                    gameRunning = false;
                    clearInterval(timerInterval);
                    document.getElementById('finalScore').textContent = score;
                    document.getElementById('endScreen').classList.remove('hidden');
                }
            }, 1000);

            requestAnimationFrame(loop);
        }

        canvas.addEventListener('mousedown', throwGrenade);
        canvas.addEventListener('touchstart', (e) => { e.preventDefault(); throwGrenade(e.touches[0]); });

        function throwGrenade(e) {
            if (!gameRunning) return;
            const rect = canvas.getBoundingClientRect();
            const tx = (e.clientX || e.pageX) - rect.left;
            const ty = (e.clientY || e.pageY) - rect.top;
            grenades.push(new Grenade(tx, ty));
        }

        function loop() {
            if (!gameRunning) return;
            ctx.clearRect(0, 0, width, height);

            frameCount++;
            if (frameCount % spawnRate === 10) camps.push(new Camp());

            camps.sort((a, b) => a.y - b.y);
            camps.forEach(c => { c.update(); c.draw(); });

            for (let i = grenades.length - 1; i >= 0; i--) {
                let g = grenades[i];
                g.update();
                g.draw();
                if (g.exploded) grenades.splice(i, 1);
            }

            for (let i = particles.length - 1; i >= 0; i--) {
                let p = particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.life -= 0.05;
                p.vx *= 0.9;
                p.vy *= 0.9;
                ctx.globalAlpha = p.life;
                ctx.fillStyle = p.color;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.life * 20, 0, Math.PI * 2);
                ctx.fill();
                ctx.globalAlpha = 1;
                if (p.life <= 1) particles.splice(i, 1);
            }

            // Remove camps that go offscreen or are too old, no game over for too many camps
            for (let i = camps.length - 1; i >= 0; i--) {
                if (camps[i].size >= camps[i].maxSize + 100) {
                    camps.splice(i, 1);
                }
            }

            requestAnimationFrame(loop);
        }
    </script>
</body>

</html>